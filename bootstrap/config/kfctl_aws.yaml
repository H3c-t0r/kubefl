apiVersion: kfdef.apps.kubeflow.org/v1alpha1
kind: KfDef
metadata:
  name: kubeflow-aws
  namespace: kubeflow
spec:
  platform: aws
  componentParams:
    application:
      - name: overlay
        value: application
    argo:
      - name: overlay
        value: istio
    bootstrap:
      - name: webhookNamePrefix
        value: admission-webhook-
    centraldashboard:
      - name: overlay
        value: istio
      - name: overlay
        value: application
    istio:
      - name: clusterRbacConfig
        value: "OFF"
    istio-crds:
      - name: namespace
        value: istio-system
    istio-install:
      - name: namespace
        value: istio-system
    jupyter-web-app:
      - name: overlay
        value: istio
      - name: overlay
        value: application
    katib-ui:
      - name: overlay
        value: istio
    metadata-ui:
      - name: overlay
        value: istio
    minio:
      - name: minioPvName
        value: minio-pv
      - name: minioPvcName
        value: minio-pv-claim
    mysql:
      - name: mysqlPvName
        value: mysql-pv
      - name: mysqlPvcName
        value: mysql-pv-claim
    notebook-controller:
      - name: overlay
        value: istio
      - name: overlay
        value: application
    pipelines-ui:
      - name: overlay
        value: istio
    profiles:
      - name: overlay
        value: istio
    pytorch-operator:
      - name: overlay
        value: application
    spartakus:
      - initRequired: true
        name: usageId
        value: <randomly-generated-id>
      - initRequired: true
        name: reportUsage
        value: "true"
    tensorboard:
      - name: overlay
        value: istio
    tf-job-operator:
      - name: overlay
        value: istio
    istio-ingress:
      - name: namespace
        value: istio-system
        initRequired: true
    aws-alb-ingress-controller:
      - name: clusterName
        value: kubeflow-aws
        initRequired: true
    fluentd-cloud-watch:
      - name: clusterName
        value: kubeflow-aws
        initRequired: true
      - name: region
        value: us-west-2
        initRequired: true
  components:
    - istio-crds
    - istio-install
    - istio
    - application-crds
    - application
    - metacontroller
    - argo
    - centraldashboard
    - webhook
    - bootstrap
    - jupyter-web-app
    - katib-db
    - katib-manager
    - katib-controller
    - katib-ui
    - metrics-collector
    - metadata
    - suggestion
    - notebook-controller
    - pytorch-job-crds
    - pytorch-operator
    - spartakus
    - tensorboard
    - tf-job-operator
    - api-service
    - minio
    - mysql
    - persistent-agent
    - pipelines-runner
    - pipelines-ui
    - pipelines-viewer
    - scheduledworkflow
    - profiles
    - istio-ingress
    - aws-alb-ingress-controller
    - nvidia-device-plugin
  enableApplications: true
  packageManager: kustomize
  packages:
    - argo
    - common
    - examples
    - admission-webhook
    - jupyter
    - katib-v1alpha2
    - metacontroller
    - metadata
    - modeldb
    - mpi-job
    - pytorch-job
    - seldon
    - tensorboard
    - tf-serving
    - tf-training
    - pipeline
    - istio
    - application
    - aws
    - profiles
  region: us-west-2
  repos:
    - name: kubeflow
      uri: https://github.com/kubeflow/kubeflow/tarball/master?archive=tar.gz
    - name: manifests
      root: manifests-master
      uri: https://github.com/kubeflow/manifests/archive/master.tar.gz
  useBasicAuth: false
  useIstio: true
  version: master