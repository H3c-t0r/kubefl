{"ast":null,"code":"var _jsxFileName = \"/Users/allan.chepkoy/cloud/kubeflow/components/zoradashboard/src/contexts/get-profile-context.js\",\n    _s = $RefreshSig$();\n\nimport { createContext, useEffect, useReducer } from \"react\";\nimport PropTypes from 'prop-types';\nimport { profileAPI } from \"../api/profile\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst initialState = {\n  loading: true,\n  profile: null\n};\nconst handlers = {\n  GET_PROFILE: (state, action) => {\n    const {\n      profile\n    } = action.payload;\n    return { ...state,\n      profile,\n      loading: false\n    };\n  }\n};\n\nconst reducer = (state, action) => handlers[action.type] ? handlers[action.type](state, action) : state;\n\nexport const ProfileContext = /*#__PURE__*/createContext({ ...initialState,\n  get // getProfile: () => Promise.resolve()\n\n});\nexport const ProfileProvider = props => {\n  _s();\n\n  const {\n    children\n  } = props;\n  const [state, dispatch] = useReducer(reducer, initialState);\n  useEffect(() => {\n    // console.log('here')\n    const initialize = async () => {\n      try {\n        const accessToken = window.localStorage.getItem('accessToken');\n        console.log(accessToken);\n\n        if (accessToken) {\n          const profile = await profileAPI.me(accessToken);\n          dispatch({\n            type: 'GET_PROFILE',\n            payload: {\n              loading: false,\n              profile\n            }\n          });\n        } else {\n          dispatch({\n            type: 'GET_PROFILE',\n            payload: {\n              loading: true,\n              profile: null\n            }\n          });\n        }\n      } catch (err) {\n        console.error(err);\n        dispatch({\n          type: 'GET_PROFILE',\n          payload: {\n            isAuthenticated: false,\n            user: null\n          }\n        });\n      }\n    };\n\n    initialize();\n  }, []);\n\n  const getProfile = async () => {\n    try {\n      console.log(\"accessToken\");\n      const accessToken = window.localStorage.getItem('accessToken');\n      console.log(accessToken);\n\n      if (accessToken) {\n        console.log(\"before calling func\");\n        const profile = await profileAPI.me(accessToken);\n        dispatch({\n          type: 'GET_PROFILE',\n          payload: {\n            loading: false,\n            profile\n          }\n        });\n      } else {\n        dispatch({\n          type: 'GET_PROFILE',\n          payload: {\n            loading: true,\n            profile: null\n          }\n        });\n      }\n    } catch (err) {\n      console.error(err);\n      dispatch({\n        type: 'GET_PROFILE',\n        payload: {\n          isAuthenticated: false,\n          user: null\n        }\n      });\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(ProfileContext.Provider, {\n    value: { ...state,\n      getProfile\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 114,\n    columnNumber: 9\n  }, this);\n};\n\n_s(ProfileProvider, \"bgCdjuTOmPdSBRwTap80EFd9Y3U=\");\n\n_c = ProfileProvider;\nProfileContext.propTypes = {\n  children: PropTypes.node.isRequired\n};\n\nvar _c;\n\n$RefreshReg$(_c, \"ProfileProvider\");","map":{"version":3,"sources":["/Users/allan.chepkoy/cloud/kubeflow/components/zoradashboard/src/contexts/get-profile-context.js"],"names":["createContext","useEffect","useReducer","PropTypes","profileAPI","initialState","loading","profile","handlers","GET_PROFILE","state","action","payload","reducer","type","ProfileContext","get","ProfileProvider","props","children","dispatch","initialize","accessToken","window","localStorage","getItem","console","log","me","err","error","isAuthenticated","user","getProfile","propTypes","node","isRequired"],"mappings":"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","sourcesContent":["import { createContext, useEffect, useReducer } from \"react\";\nimport PropTypes from 'prop-types';\nimport { profileAPI } from \"../api/profile\";\n\nconst initialState = {\n    loading: true,\n    profile: null\n}\n\nconst handlers = {\n    GET_PROFILE: (state, action) => {\n        const {profile} = action.payload;\n        return {\n            ...state,\n            profile,\n            loading: false\n        };\n    }\n};\n\nconst reducer = (state, action) => (handlers[action.type]\n    ? handlers[action.type](state, action)\n    : state);\n\nexport const ProfileContext = createContext({\n    ...initialState,\n    get\n    // getProfile: () => Promise.resolve()\n});\n\nexport const ProfileProvider = (props) => {\n    const { children } = props;\n    const [state, dispatch] = useReducer(reducer, initialState);\n\n    useEffect(() => {\n        // console.log('here')\n        const initialize = async () => {\n            try {\n                const accessToken = window.localStorage.getItem('accessToken');\n                console.log(accessToken)\n                if (accessToken){\n                    const profile = await profileAPI.me(accessToken);\n\n                    dispatch({\n                        type: 'GET_PROFILE',\n                        payload: {\n                            loading: false,\n                            profile\n                        }\n                    });\n                } else {\n                    dispatch({\n                        type: 'GET_PROFILE',\n                        payload: {\n                            loading: true,\n                            profile: null\n                        }\n                    });\n                }\n\n            } catch (err) {\n                console.error(err);\n                dispatch({\n                    type: 'GET_PROFILE',\n                    payload: {\n                        isAuthenticated: false,\n                        user: null\n                    }\n                });\n            }\n        };\n        initialize();\n    }, []);\n\n    const getProfile = async () => {\n        try {\n            console.log(\"accessToken\")\n            const accessToken = window.localStorage.getItem('accessToken');\n            console.log(accessToken)\n            if (accessToken){\n                console.log(\"before calling func\")\n                const profile = await profileAPI.me(accessToken);\n\n                dispatch({\n                    type: 'GET_PROFILE',\n                    payload: {\n                        loading: false,\n                        profile\n                    }\n                });\n            } else {\n                dispatch({\n                    type: 'GET_PROFILE',\n                    payload: {\n                        loading: true,\n                        profile: null\n                    }\n                });\n            }\n\n        } catch (err) {\n            console.error(err);\n            dispatch({\n                type: 'GET_PROFILE',\n                payload: {\n                    isAuthenticated: false,\n                    user: null\n                }\n            });\n        }\n    };\n\n    return (\n        <ProfileContext.Provider\n            value={{\n                ...state,\n                getProfile\n            }}\n        >\n            {children}\n        </ProfileContext.Provider>\n    );\n};\n\nProfileContext.propTypes = {\n    children: PropTypes.node.isRequired\n}"]},"metadata":{},"sourceType":"module"}