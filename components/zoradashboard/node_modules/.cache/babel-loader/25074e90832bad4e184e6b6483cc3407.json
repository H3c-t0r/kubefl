{"ast":null,"code":"import { generateResourceId } from '../utils/generate-resource-id';\nimport { sign, decode, JWT_SECRET, JWT_EXPIRES_IN } from '../utils/jwt';\nimport { wait } from '../utils/wait';\nimport axios from \"axios\"; // const axios = require('axios').default;\n\naxios.defaults.headers.post['Content-Type'] = 'application/json';\n\nclass AuthApi {\n  async login({\n    username,\n    password\n  }) {\n    console.log(username, password);\n\n    try {\n      axios.post(\"http://localhost:8000/auth/jwt/create\", {\n        \"username\": username,\n        \"password\": password\n      }).then(res => {\n        const {\n          token\n        } = res.data;\n        localStorage.setItem(\"jwtToken\", token);\n        console.log(token);\n        resolve(token);\n      });\n    } catch (error) {\n      const {\n        status,\n        statusText\n      } = error.response;\n      console.log(`Error! HTTP Status: ${status} ${statusText}`);\n    } // await wait(500);\n    // const resp = axios.post(\n    //   'http://localhost:8000/auth/jwt/create',{\n    //     \"username\":username,\n    //     \"password\":password\n    //   }).then(resp => {\n    //     console.log(resp.data);\n    // }).catch(err => {\n    //     // Handle Error Here\n    //     console.error(err);\n    // });\n    // axios.post('/auth/jwt/create')\n    //     .then(resp => {\n    //         console.log(resp.data);\n    //     })\n    //     .catch(err => {\n    //         // Handle Error Here\n    //         console.error(err);\n    //     });\n    // return new Promise((resolve, reject) => {\n    //   try {\n    //     // Find the user\n    //     // const user = users.find((_user) => _user.email === email);\n    //     // if (!user || (user.password !== password)) {\n    //     //   reject(new Error('Please check your email and password'));\n    //     //   return;\n    //     // }\n    //     // const resp = axios.post(\n    //     //   '/auth/jwt/create/',{\n    //     //     \"username\":username,\n    //     //     \"password\":password\n    //     //   });\n    //       // console.log(resp.data)\n    //     // Create the access token\n    //     // const accessToken = sign({ userId: user.id }, JWT_SECRET, { expiresIn: JWT_EXPIRES_IN });\n    //   } catch (err) {\n    //     console.error('[Auth Api]: ', err);\n    //     reject(new Error('Internal server error'));\n    //   }\n    // });\n\n  }\n\n  async register({\n    email,\n    name,\n    password\n  }) {\n    await wait(1000);\n    return new Promise((resolve, reject) => {\n      try {\n        // Check if a user already exists\n        let user = users.find(_user => _user.email === email);\n\n        if (user) {\n          reject(new Error('User already exists'));\n          return;\n        }\n\n        user = {\n          id: generateResourceId(),\n          avatar: null,\n          email,\n          name,\n          password\n        };\n        users.push(user);\n        const accessToken = sign({\n          userId: user.id\n        }, JWT_SECRET, {\n          expiresIn: JWT_EXPIRES_IN\n        });\n        resolve(accessToken);\n      } catch (err) {\n        console.error('[Auth Api]: ', err);\n        reject(new Error('Internal server error'));\n      }\n    });\n  }\n\n  me(accessToken) {\n    return new Promise((resolve, reject) => {\n      try {\n        // Decode access token\n        const {\n          userId\n        } = decode(accessToken); // Find the user\n\n        const user = users.find(_user => _user.id === userId);\n\n        if (!user) {\n          reject(new Error('Invalid authorization token'));\n          return;\n        }\n\n        resolve({\n          id: user.id,\n          avatar: user.avatar,\n          email: user.email,\n          name: user.name\n        });\n      } catch (err) {\n        console.error('[Auth Api]: ', err);\n        reject(new Error('Internal server error'));\n      }\n    });\n  }\n\n}\n\nexport const authApi = new AuthApi();","map":{"version":3,"sources":["/Users/allan.chepkoy/cloud/kubeflow/components/zoradashboard/src/api/auth.js"],"names":["generateResourceId","sign","decode","JWT_SECRET","JWT_EXPIRES_IN","wait","axios","defaults","headers","post","AuthApi","login","username","password","console","log","then","res","token","data","localStorage","setItem","resolve","error","status","statusText","response","register","email","name","Promise","reject","user","users","find","_user","Error","id","avatar","push","accessToken","userId","expiresIn","err","me","authApi"],"mappings":"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","sourcesContent":["import { generateResourceId } from '../utils/generate-resource-id';\nimport { sign, decode, JWT_SECRET, JWT_EXPIRES_IN } from '../utils/jwt';\nimport { wait } from '../utils/wait';\nimport axios from \"axios\"\n// const axios = require('axios').default;\naxios.defaults.headers.post['Content-Type'] ='application/json';\n\n\nclass AuthApi {\n  async login({ username, password }) {\n    console.log(username, password)\n\n    try {\n      axios.post(\"http://localhost:8000/auth/jwt/create\", {\n            \"username\":username,\n            \"password\":password\n          }).then(\n            res => {\n              const {token} = res.data;\n              localStorage.setItem(\"jwtToken\", token);\n              console.log(token)\n              resolve(token);\n            }\n          )\n      } catch (error){\n        const {\n          status,\n          statusText\n        } = error.response;\n        console.log(`Error! HTTP Status: ${status} ${statusText}`);\n      }\n\n  \n\n\n\n    // await wait(500);\n\n    // const resp = axios.post(\n    //   'http://localhost:8000/auth/jwt/create',{\n    //     \"username\":username,\n    //     \"password\":password\n    //   }).then(resp => {\n    //     console.log(resp.data);\n    // }).catch(err => {\n    //     // Handle Error Here\n    //     console.error(err);\n    // });\n\n    // axios.post('/auth/jwt/create')\n    //     .then(resp => {\n    //         console.log(resp.data);\n    //     })\n    //     .catch(err => {\n    //         // Handle Error Here\n    //         console.error(err);\n    //     });\n\n    \n    // return new Promise((resolve, reject) => {\n    //   try {\n    //     // Find the user\n    //     // const user = users.find((_user) => _user.email === email);\n\n    //     // if (!user || (user.password !== password)) {\n    //     //   reject(new Error('Please check your email and password'));\n    //     //   return;\n    //     // }\n      \n    //     // const resp = axios.post(\n    //     //   '/auth/jwt/create/',{\n    //     //     \"username\":username,\n    //     //     \"password\":password\n    //     //   });\n\n\n    //       // console.log(resp.data)\n\n\n    //     // Create the access token\n    //     // const accessToken = sign({ userId: user.id }, JWT_SECRET, { expiresIn: JWT_EXPIRES_IN });\n\n        \n    //   } catch (err) {\n    //     console.error('[Auth Api]: ', err);\n    //     reject(new Error('Internal server error'));\n    //   }\n    // });\n  }\n\n  async register({ email, name, password }) {\n    await wait(1000);\n\n    return new Promise((resolve, reject) => {\n      try {\n        // Check if a user already exists\n        let user = users.find((_user) => _user.email === email);\n\n        if (user) {\n          reject(new Error('User already exists'));\n          return;\n        }\n\n        user = {\n          id: generateResourceId(),\n          avatar: null,\n          email,\n          name,\n          password\n        };\n\n        users.push(user);\n\n        const accessToken = sign({ userId: user.id }, JWT_SECRET, { expiresIn: JWT_EXPIRES_IN });\n\n        resolve(accessToken);\n      } catch (err) {\n        console.error('[Auth Api]: ', err);\n        reject(new Error('Internal server error'));\n      }\n    });\n  }\n\n  me(accessToken) {\n    return new Promise((resolve, reject) => {\n      try {\n        // Decode access token\n        const { userId } = decode(accessToken);\n\n        // Find the user\n        const user = users.find((_user) => _user.id === userId);\n\n        if (!user) {\n          reject(new Error('Invalid authorization token'));\n          return;\n        }\n\n        resolve({\n          id: user.id,\n          avatar: user.avatar,\n          email: user.email,\n          name: user.name\n        });\n      } catch (err) {\n        console.error('[Auth Api]: ', err);\n        reject(new Error('Internal server error'));\n      }\n    });\n  }\n}\n\nexport const authApi = new AuthApi();\n"]},"metadata":{},"sourceType":"module"}