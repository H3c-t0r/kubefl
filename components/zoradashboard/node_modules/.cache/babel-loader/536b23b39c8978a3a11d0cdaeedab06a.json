{"ast":null,"code":"var _jsxFileName = \"/Users/allan.chepkoy/cloud/kubeflow/components/zoradashboard/src/contexts/get-profile-context.js\",\n    _s = $RefreshSig$();\n\nimport { createContext, useEffect, useReducer } from \"react\";\nimport PropTypes from 'prop-types';\nimport { profileAPI } from \"../api/profile\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst initialState = {\n  loading: true,\n  profile: null\n};\nconst handlers = {\n  GET_PROFILE: (state, action) => {\n    const {\n      profile\n    } = action.payload;\n    return { ...state,\n      profile,\n      loading: false\n    };\n  }\n};\n\nconst reducer = (state, action) => handlers[action.type] ? handlers[action.type](state, action) : state;\n\nexport const ProfileContext = /*#__PURE__*/createContext({ ...initialState,\n  get_profile: () => Promise.resolve()\n});\n\nconst get_profile = async () => {\n  try {\n    const accessToken = window.localStorage.getItem('accessToken');\n    console.log(accessToken);\n\n    if (accessToken) {\n      const profile = await profileAPI.me(accessToken);\n      dispatch({\n        type: 'GET_PROFILE',\n        payload: {\n          loading: false,\n          profile\n        }\n      });\n    } else {\n      dispatch({\n        type: 'GET_PROFILE',\n        payload: {\n          loading: true,\n          profile: null\n        }\n      });\n    }\n  } catch (err) {\n    console.error(err);\n    dispatch({\n      type: 'GET_PROFILE',\n      payload: {\n        isAuthenticated: false,\n        user: null\n      }\n    });\n  }\n};\n\nexport const ProfileProvider = () => {\n  _s();\n\n  const {\n    children\n  } = props;\n  const {\n    state,\n    dispatch\n  } = useReducer(reducer, initialState);\n  useEffect(() => {\n    console.log('here');\n\n    const initialize = async () => {\n      try {\n        const accessToken = window.localStorage.getItem('accessToken');\n        console.log(accessToken);\n\n        if (accessToken) {\n          const profile = await profileAPI.me(accessToken);\n          dispatch({\n            type: 'GET_PROFILE',\n            payload: {\n              loading: false,\n              profile\n            }\n          });\n        } else {\n          dispatch({\n            type: 'GET_PROFILE',\n            payload: {\n              loading: true,\n              profile: null\n            }\n          });\n        }\n      } catch (err) {\n        console.error(err);\n        dispatch({\n          type: 'GET_PROFILE',\n          payload: {\n            isAuthenticated: false,\n            user: null\n          }\n        });\n      }\n    };\n\n    initialize();\n  }, []);\n  return /*#__PURE__*/_jsxDEV(ProfileContext.Provider, {\n    value: { ...state,\n      get_profile\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 112,\n    columnNumber: 9\n  }, this);\n};\n\n_s(ProfileProvider, \"61yEf+bMHBphzFLL672XVwM14F4=\");\n\n_c = ProfileProvider;\nProfileContext.propTypes = {\n  children: PropTypes.node.isRequired\n};\n\nvar _c;\n\n$RefreshReg$(_c, \"ProfileProvider\");","map":{"version":3,"sources":["/Users/allan.chepkoy/cloud/kubeflow/components/zoradashboard/src/contexts/get-profile-context.js"],"names":["createContext","useEffect","useReducer","PropTypes","profileAPI","initialState","loading","profile","handlers","GET_PROFILE","state","action","payload","reducer","type","ProfileContext","get_profile","Promise","resolve","accessToken","window","localStorage","getItem","console","log","me","dispatch","err","error","isAuthenticated","user","ProfileProvider","children","props","initialize","propTypes","node","isRequired"],"mappings":"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","sourcesContent":["import { createContext, useEffect, useReducer } from \"react\";\nimport PropTypes from 'prop-types';\nimport { profileAPI } from \"../api/profile\";\n\nconst initialState = {\n    loading: true,\n    profile: null\n}\n\nconst handlers = {\n    GET_PROFILE: (state, action) => {\n        const {profile} = action.payload;\n        return {\n            ...state,\n            profile,\n            loading: false\n        };\n    }\n};\n\nconst reducer = (state, action) => (handlers[action.type]\n    ? handlers[action.type](state, action)\n    : state);\n\nexport const ProfileContext = createContext({\n    ...initialState,\n    get_profile: () => Promise.resolve(),\n});\n\n\nconst get_profile = async () => {\n    try {\n        const accessToken = window.localStorage.getItem('accessToken');\n        console.log(accessToken)\n        if (accessToken){\n            const profile = await profileAPI.me(accessToken);\n\n            dispatch({\n                type: 'GET_PROFILE',\n                payload: {\n                    loading: false,\n                    profile\n                }\n            });\n        } else {\n            dispatch({\n                type: 'GET_PROFILE',\n                payload: {\n                    loading: true,\n                    profile: null\n                }\n            });\n        }\n\n    } catch (err) {\n        console.error(err);\n        dispatch({\n            type: 'GET_PROFILE',\n            payload: {\n                isAuthenticated: false,\n                user: null\n            }\n        });\n    }\n};\n\nexport const ProfileProvider = () => {\n    const { children } = props;\n    const {state, dispatch} = useReducer(reducer, initialState);\n\n    useEffect(() => {\n        console.log('here')\n        const initialize = async () => {\n            try {\n                const accessToken = window.localStorage.getItem('accessToken');\n                console.log(accessToken)\n                if (accessToken){\n                    const profile = await profileAPI.me(accessToken);\n\n                    dispatch({\n                        type: 'GET_PROFILE',\n                        payload: {\n                            loading: false,\n                            profile\n                        }\n                    });\n                } else {\n                    dispatch({\n                        type: 'GET_PROFILE',\n                        payload: {\n                            loading: true,\n                            profile: null\n                        }\n                    });\n                }\n\n            } catch (err) {\n                console.error(err);\n                dispatch({\n                    type: 'GET_PROFILE',\n                    payload: {\n                        isAuthenticated: false,\n                        user: null\n                    }\n                });\n            }\n        };\n        initialize();\n    }, []);\n\n    return (\n        <ProfileContext.Provider\n            value={{\n                ...state,\n                get_profile\n            }}\n        >\n            {children}\n        </ProfileContext.Provider>\n    );\n};\n\nProfileContext.propTypes = {\n    children: PropTypes.node.isRequired\n}"]},"metadata":{},"sourceType":"module"}