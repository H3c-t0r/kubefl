{"ast":null,"code":"import { generateResourceId } from '../utils/generate-resource-id';\nimport { sign, decode, JWT_SECRET, JWT_EXPIRES_IN } from '../utils/jwt';\nimport { wait } from '../utils/wait';\nconst users = [{\n  id: '5e86809283e28b96d2d38537',\n  avatar: '/static/user-chen_simmons.png',\n  email: 'demo@devias.io',\n  name: 'Chen Simmons',\n  password: 'Password123!'\n}];\n\nclass AuthApi {\n  async login({\n    email,\n    password\n  }) {\n    await wait(500);\n    return new Promise((resolve, reject) => {\n      try {\n        // Find the user\n        // const user = users.find((_user) => _user.email === email);\n        if (!user || user.password !== password) {\n          reject(new Error('Please check your email and password'));\n          return;\n        } // Create the access token\n\n\n        const accessToken = sign({\n          userId: user.id\n        }, JWT_SECRET, {\n          expiresIn: JWT_EXPIRES_IN\n        });\n        resolve(accessToken);\n      } catch (err) {\n        console.error('[Auth Api]: ', err);\n        reject(new Error('Internal server error'));\n      }\n    });\n  }\n\n  async register({\n    email,\n    name,\n    password\n  }) {\n    await wait(1000);\n    return new Promise((resolve, reject) => {\n      try {\n        // Check if a user already exists\n        let user = users.find(_user => _user.email === email);\n\n        if (user) {\n          reject(new Error('User already exists'));\n          return;\n        }\n\n        user = {\n          id: generateResourceId(),\n          avatar: null,\n          email,\n          name,\n          password\n        };\n        users.push(user);\n        const accessToken = sign({\n          userId: user.id\n        }, JWT_SECRET, {\n          expiresIn: JWT_EXPIRES_IN\n        });\n        resolve(accessToken);\n      } catch (err) {\n        console.error('[Auth Api]: ', err);\n        reject(new Error('Internal server error'));\n      }\n    });\n  }\n\n  me(accessToken) {\n    return new Promise((resolve, reject) => {\n      try {\n        // Decode access token\n        const {\n          userId\n        } = decode(accessToken); // Find the user\n\n        const user = users.find(_user => _user.id === userId);\n\n        if (!user) {\n          reject(new Error('Invalid authorization token'));\n          return;\n        }\n\n        resolve({\n          id: user.id,\n          avatar: user.avatar,\n          email: user.email,\n          name: user.name\n        });\n      } catch (err) {\n        console.error('[Auth Api]: ', err);\n        reject(new Error('Internal server error'));\n      }\n    });\n  }\n\n}\n\nexport const authApi = new AuthApi();","map":{"version":3,"sources":["/Users/allan.chepkoy/cloud/kubeflow/components/zoradashboard/src/api/auth.js"],"names":["generateResourceId","sign","decode","JWT_SECRET","JWT_EXPIRES_IN","wait","users","id","avatar","email","name","password","AuthApi","login","Promise","resolve","reject","user","Error","accessToken","userId","expiresIn","err","console","error","register","find","_user","push","me","authApi"],"mappings":"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","sourcesContent":["import { generateResourceId } from '../utils/generate-resource-id';\nimport { sign, decode, JWT_SECRET, JWT_EXPIRES_IN } from '../utils/jwt';\nimport { wait } from '../utils/wait';\n\nconst users = [\n  {\n    id: '5e86809283e28b96d2d38537',\n    avatar: '/static/user-chen_simmons.png',\n    email: 'demo@devias.io',\n    name: 'Chen Simmons',\n    password: 'Password123!'\n  }\n];\n\nclass AuthApi {\n  async login({ email, password }) {\n    await wait(500);\n\n    return new Promise((resolve, reject) => {\n      try {\n        // Find the user\n        // const user = users.find((_user) => _user.email === email);\n\n        if (!user || (user.password !== password)) {\n          reject(new Error('Please check your email and password'));\n          return;\n        }\n        \n\n        // Create the access token\n        const accessToken = sign({ userId: user.id }, JWT_SECRET, { expiresIn: JWT_EXPIRES_IN });\n\n        resolve(accessToken);\n      } catch (err) {\n        console.error('[Auth Api]: ', err);\n        reject(new Error('Internal server error'));\n      }\n    });\n  }\n\n  async register({ email, name, password }) {\n    await wait(1000);\n\n    return new Promise((resolve, reject) => {\n      try {\n        // Check if a user already exists\n        let user = users.find((_user) => _user.email === email);\n\n        if (user) {\n          reject(new Error('User already exists'));\n          return;\n        }\n\n        user = {\n          id: generateResourceId(),\n          avatar: null,\n          email,\n          name,\n          password\n        };\n\n        users.push(user);\n\n        const accessToken = sign({ userId: user.id }, JWT_SECRET, { expiresIn: JWT_EXPIRES_IN });\n\n        resolve(accessToken);\n      } catch (err) {\n        console.error('[Auth Api]: ', err);\n        reject(new Error('Internal server error'));\n      }\n    });\n  }\n\n  me(accessToken) {\n    return new Promise((resolve, reject) => {\n      try {\n        // Decode access token\n        const { userId } = decode(accessToken);\n\n        // Find the user\n        const user = users.find((_user) => _user.id === userId);\n\n        if (!user) {\n          reject(new Error('Invalid authorization token'));\n          return;\n        }\n\n        resolve({\n          id: user.id,\n          avatar: user.avatar,\n          email: user.email,\n          name: user.name\n        });\n      } catch (err) {\n        console.error('[Auth Api]: ', err);\n        reject(new Error('Internal server error'));\n      }\n    });\n  }\n}\n\nexport const authApi = new AuthApi();\n"]},"metadata":{},"sourceType":"module"}